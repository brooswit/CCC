os.loadAPI("module")
module.require("json")

local store = {}

function load()
  local file
  if fs.exists("disk/config.json") then
    file = fs.open("disk/config.json", "r")
  elseif fs.exists("config.json") then
    local file = fs.open("config.json", "r")
  end
  if file then
    serializedConfig = file.readAll()
    file.close()
    store = json.decode(serializedConfig)
    save()
  end
end

function get(key)
  load()
  return store[key]
end

function save()
  local file = fs.open("config.json", "w")
  file.write(json.encode(store))
  file.close()
end

function set(key, value)
  store[key] = value
  save()
end
