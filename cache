os.loadAPI("module")
module.require("json")

local store = {}

function save()
  local file = fs.open("cache.json", "w")
  file.write(json.encode(store))
  file.close()
end

function ensure()
  if not fs.exists("cache.json")
    save()
  end
end

function load()
  ensure()
  local file = fs.open("cache.json", "r")
  serializedCache = file.readAll()
  file.close()
  
  store = json.parse(serializedCache)
end

function get(key)
  load()
  return store[key]
end

function set(key, value)
  store[key] = value
  save()
end
